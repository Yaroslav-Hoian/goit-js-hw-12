{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getImagesByQuery(query, page) {\n    const response = await axios.get(\"https://pixabay.com/api/\", {\n        params: {\n            key: \"51210907-49260f6ab8f7fee8b1bad09dd\",\n            q: query,\n            page: page,\n            per_page: 15,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true\n        }\n    });\n    return response.data;\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst list = document.querySelector(\".gallery\");\nconst loaderSpan = document.querySelector(\".loader\");\nconst btnLoad = document.querySelector(\"[type='button']\");\n\nconst lightbox = new SimpleLightbox('.gallery-item a', {\n    captionsData: \"alt\",\n    captionDelay: 250\n})\n\nexport function createGallery(images) {\n    const markup = images.hits.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n    <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"\n            />\n        </a>\n        <ul class=\"list-box\">\n            <li class=\"item-description\">\n                <h3 class=\"subtitle\">Likes</h3>\n                <p class=\"subtext\">${likes}</p>\n            </li>\n            <li class=\"item-description\">\n                <h3 class=\"subtitle\">Views</h3>\n                <p class=\"subtext\">${views}</p>\n            </li>\n            <li class=\"item-description\">\n                <h3 class=\"subtitle\">Comments</h3>\n                <p class=\"subtext\">${comments}</p>\n            </li>\n            <li class=\"item-description\">\n                <h3 class=\"subtitle\">Downloads</h3>\n                <p class=\"subtext\">${downloads}</p>\n            </li>\n        </ul>\n    </li>\n`)\n        .join('');\n\n    list.insertAdjacentHTML(\"beforeend\", markup);\n\n    lightbox.refresh();\n}\n\nexport function clearGallery() {\n    list.innerHTML = '';\n}\n\nexport function showLoader() {\n    loaderSpan.classList.remove(\"hidden\");\n}\n\nexport function hideLoader() {\n    loaderSpan.classList.add(\"hidden\");\n}\n\nexport function showLoadMoreButton() {\n    btnLoad.classList.remove(\"hidden\");\n}\n\nexport function hideLoadMoreButton() {\n    btnLoad.classList.add(\"hidden\");\n}   ","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api\";\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from \"./js/render-functions\";\n\nconst form = document.querySelector(\".form\");\nconst input = form.querySelector(\"input[name='search-text']\");\nconst btnLoad = document.querySelector(\"[type='button']\");\n\nform.addEventListener(\"submit\", handleSubmit);\n\nlet searchText = \"\"\nlet page = 1;\nlet limit = 0;\nlet totalHits = 0;\n\nfunction handleSubmit(ev) {\n    ev.preventDefault();\n    hideLoadMoreButton()\n    clearGallery();\n    page = 1;\n\n    searchText = input.value.trim();;\n    if (searchText === \"\") {\n        iziToast.error({\n            title: `Please write word`,\n            position: \"topRight\"\n        });\n        return form.reset();\n    }\n\n    showLoader()\n    setTimeout(async () => {\n        try {\n            const posts = await getImagesByQuery(searchText, page)\n            totalHits = posts.totalHits;\n            limit = posts.hits.length;\n            if (limit === 0) {\n                return iziToast.error({\n                    title: `Sorry, there are no images matching your search ${searchText}. Please try again!`,\n                    position: \"topRight\"\n                })\n            } createGallery(posts);\n\n            if (totalHits > limit) {\n                showLoadMoreButton();\n            } else {\n                iziToast.info({\n                    title: `We're sorry, but you've reached the end of search results.`,\n                    position: \"topRight\"\n                });\n            }\n        } catch (error) {\n            iziToast.error({\n                title: error.message,\n            });\n        }\n        finally {\n            hideLoader()\n        }\n    }, 1500)\n\n    \n    form.reset();\n}\n\nbtnLoad.addEventListener(\"click\", () => {\n    page++\n    hideLoadMoreButton()\n    showLoader()\n    const totalPage = Math.ceil(totalHits / limit);\n\n    setTimeout(async () => {\n        try {\n            const posts = await getImagesByQuery(searchText, page);\n            createGallery(posts);\n\n            if (page >= totalPage) {\n                hideLoadMoreButton()\n                iziToast.info({\n                    title: `We're sorry, but you've reached the end of search results.`,\n                    position: \"topRight\"\n                });\n            } else {\n                showLoadMoreButton()\n            }\n\n            const card = document.querySelector(\".gallery-item\");\n            if (card) {\n                const cardHeight = card.getBoundingClientRect().height; \n                window.scrollBy({\n                    top: cardHeight * 2,\n                    behavior: \"smooth\",\n                });\n            }\n        }\n        catch (error) {\n            iziToast.error({\n                title: error.message,\n            });\n        }\n        finally {\n            hideLoader()\n        }\n    }, 1500)\n})\n\n"],"names":["getImagesByQuery","query","page","axios","list","loaderSpan","btnLoad","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","input","handleSubmit","searchText","limit","totalHits","ev","iziToast","posts","error","totalPage","card","cardHeight"],"mappings":"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"}